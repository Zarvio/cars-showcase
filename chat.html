<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pinora Â· Chats</title>
<link rel="icon" type="image/png" href="default.jpg">
<link rel="stylesheet" href="chat.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

</head>

<body>

<div class="app">

  <!-- CHAT LIST -->
  <div id="chatListScreen">
    
<div class="header">
  <button id="FirstbackBtn">
    <i class="fa-solid fa-arrow-left"></i>
  </button>

  <span>Messages</span>

  <!-- ðŸ”¥ Group Create Button -->
  <button id="createGroupBtn" class="group-btn">
    <i class="fa-solid fa-users"></i>
  </button>
</div>


    <!-- Skeleton -->
  <div id="chatSkeleton">
  <!-- Skeleton Item 1 -->
  <div class="chat-item skeleton-item">
    <div class="skeleton-circle"></div>
    <div class="skeleton-lines">
      <div class="skeleton-line short"></div>
      <div class="skeleton-line long"></div>
    </div>
  </div>

  <!-- Skeleton Item 2 -->
  <div class="chat-item skeleton-item">
    <div class="skeleton-circle"></div>
    <div class="skeleton-lines">
      <div class="skeleton-line short"></div>
      <div class="skeleton-line long"></div>
    </div>
  </div>

  <!-- Skeleton Item 3 -->
  <div class="chat-item skeleton-item">
    <div class="skeleton-circle"></div>
    <div class="skeleton-lines">
      <div class="skeleton-line short"></div>
      <div class="skeleton-line long"></div>
    </div>
  </div>
   <div class="chat-item skeleton-item">
    <div class="skeleton-circle"></div>
    <div class="skeleton-lines">
      <div class="skeleton-line short"></div>
      <div class="skeleton-line long"></div>
    </div>
  </div>
   <div class="chat-item skeleton-item">
    <div class="skeleton-circle"></div>
    <div class="skeleton-lines">
      <div class="skeleton-line short"></div>
      <div class="skeleton-line long"></div>
    </div>
  </div>
</div>

<!-- ðŸ”¥ Group Create Popup -->
<!-- ðŸ”¥ NEW 2 STEP GROUP POPUP -->
<div id="groupPopup" class="popup hidden">
  <div class="popup-box group-popup-box">
<!-- âœ… Custom Success Popup -->
<div id="customPopup" class="custom-popup hidden">
   <div id="popupMessage"></div>
</div>
    <!-- STEP 1 -->
    <div id="groupStep1">
      <h3>Create New Group</h3>

      <input type="text" id="groupUserSearch" placeholder="Search username">

      <div id="userSelectList" class="user-select-list"></div>

      <button id="groupNextBtn">Next</button>
      <button id="closeGroupPopup">Cancel</button>
    </div>

    <!-- STEP 2 -->
    <div id="groupStep2" class="hidden">
      <h3>Enter Group Name</h3>

      <input type="text" id="groupNameInput" placeholder="Enter group name">

      <button id="createGroupConfirmBtn">Create Group</button>
    </div>

  </div>
</div>


    <div id="chatList"></div>
  </div>

  <!-- CHAT SCREEN -->
  <div id="chatScreen" class="hidden">

    <div class="chat-header">
  <button id="backBtn">
    <i class="fa-solid fa-arrow-left"></i>
  </button>

  <div id="chatUserInfo">
    <img id="chatUserImg">
    <div>
  <div id="chatUserName"></div>
  <div id="chatUserStatus" class="user-status"></div>
</div>

  </div>

  <!-- ðŸ“ž Call buttons -->
  <div class="chat-header-actions">
    <button id="audioCallBtn"><i class="fa-solid fa-phone"></i></button>
    <button id="videoCallBtn"><i class="fa-solid fa-video"></i></button>
    <button id="leaveGroupBtn" style="display:none;">
  <i class="fa-solid fa-right-from-bracket"></i>
</button>

  </div>
  
</div>


<!-- Group Members Popup -->
<div id="groupMembersPopup" class="hidden" style="
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.5);
display:flex;
align-items:center;
justify-content:center;
z-index:2000;
">
  <div style="
    background:#151414;
    width:90%;
    max-width:400px;
    max-height:70%;
    overflow-y:auto;
    border-radius:10px;
    padding:15px;
  ">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <h3>Group Members</h3>
      <button onclick="closeGroupMembers()">âœ•</button>
    </div>

    <div id="groupMembersList"></div>
  </div>
</div>

    <div id="chatBox"></div>

<div id="typingIndicator" class="typing-indicator"></div>
    

    <div id="replyBox" class="hidden"></div>

<div class="chat-input">

  <input id="msgInput" placeholder="Message...">

  <!-- Send button -->
  <button id="sendBtn">
    <i class="fa-solid fa-paper-plane"></i>
  </button>

  <!-- Image / Video button -->
  <button id="imgBtn">
    <i class="fa-solid fa-image"></i>
  </button>

  <!-- Hidden file input -->
  <input 
    type="file" 
    id="imgInput" 
    accept="image/*,video/*" 
    hidden
  >

</div>



<!-- Fullscreen Media Viewer -->
<div id="mediaViewer" class="media-viewer hidden">
  <span id="closeViewer">âœ•</span>
  <div id="mediaViewerContent"></div>
</div>
<div id="mediaViewer" class="media-viewer hidden">
  <span class="close-viewer">âœ•</span>
  <div id="mediaViewerContent"></div>
</div>





<!-- Coming Soon Popup -->
<div id="comingSoonPopup" class="popup hidden">
  <div class="popup-box">
    <h3>ðŸš§ Coming Soon</h3>
    <p>This feature will be available soon.</p>
    <button id="closePopup">OK</button>
  </div>
</div>
<!-- Leave Group Popup -->
<div id="leaveGroupPopup" class="popup-overlay hidden">
  <div class="popup-box">
    
    <div class="popup-title">Leave Group?</div>
    
    <div class="popup-text">
      Are you sure you want to leave this group?
    </div>

    <div class="popup-buttons">
      <button id="cancelLeaveBtn" class="cancel-btn">Cancel</button>
      <button id="confirmLeaveBtn" class="leave-btn">Leave</button>
    </div>

  </div>
</div>

<script src="chat.js"></script>
</body>
</html>
